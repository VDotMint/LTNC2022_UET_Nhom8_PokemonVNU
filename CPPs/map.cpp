#include "map.h"
#include "RenderWindow.h"
#include "tile.h"
#include "tilesheet.h"

TileSheet g2TileSheet;

int hardMap[38][55] = {
    {76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76},
    {76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76},
    {79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,76,76,76,76},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,76,76,76},
    {82,82,82,82,82,82,82,82,83,81,82,82,82,83,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,0,75,76,76,76},
    {0,0,0,0,0,0,0,0,85,0,0,4,0,0,84,0,104,105,106,104,105,106,0,0,0,0,0,0,69,70,70,70,70,70,70,70,70,71,0,0,0,0,0,0,0,5,6,5,6,85,0,75,76,76,76},
    {108,108,108,108,108,108,116,117,85,0,72,73,74,0,84,104,105,106,104,105,106,16,1,1,1,1,1,1,66,67,67,67,67,67,67,67,67,68,1,1,1,1,1,1,17,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,118,119,85,0,75,76,77,0,84,104,105,106,104,105,106,14,3,60,61,61,61,61,62,63,63,63,63,63,63,63,63,64,61,61,61,61,65,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,104,105,106,104,105,106,14,0,55,56,56,56,56,57,58,58,58,58,58,58,58,58,59,56,56,56,56,127,0,15,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,0,0,104,105,106,14,3,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,127,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,0,0,104,105,106,14,0,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,127,0,15,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,86,82,83,0,104,105,106,14,3,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,127,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,0,0,0,0,104,105,106,14,0,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,54,0,15,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,81,82,83,0,104,105,106,14,3,44,45,44,45,44,45,44,45,44,45,44,45,44,45,44,45,44,45,44,45,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,104,105,106,104,105,106,14,0,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,43,0,15,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,104,105,106,104,105,106,14,3,49,50,50,50,50,50,50,50,51,52,52,53,50,50,50,50,50,50,50,54,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,0,5,6,5,6,14,0,44,45,44,45,44,45,44,45,46,47,47,48,44,45,44,45,44,45,44,45,0,15,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,111,114,115,85,0,75,76,77,0,84,0,0,7,8,7,8,14,3,38,39,39,39,39,39,39,39,40,41,41,42,39,39,39,39,39,39,39,43,3,15,5,6,5,6,85,0,75,76,76,76},
    {111,111,111,111,111,112,120,123,85,0,75,76,77,0,84,0,0,5,6,5,6,11,12,12,12,12,12,12,33,35,35,35,35,35,35,35,35,36,12,12,12,12,12,12,13,7,8,7,8,85,0,75,76,76,76},
    {111,111,111,111,111,112,124,126,87,0,75,76,77,0,86,82,83,7,8,7,8,0,0,104,105,106,0,0,34,35,35,35,35,35,35,35,35,37,0,0,27,28,29,0,0,0,0,0,0,85,0,75,76,76,76},
    {111,111,111,111,111,112,0,0,0,0,75,76,77,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,31,32,0,0,0,0,0,0,85,0,75,76,76,76},
    {111,111,111,111,111,112,100,102,73,73,76,76,76,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,0,85,0,75,76,76,76},
    {111,111,111,111,111,112,96,95,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,4,85,0,75,76,76,76},
    {111,111,111,111,111,112,97,99,79,79,76,76,76,79,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,0,85,0,75,76,76,76},
    {111,111,111,111,111,112,0,0,0,0,75,76,77,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,0,75,76,76,76},
    {111,111,111,111,111,111,108,109,83,0,75,76,77,0,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,87,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,88,89,18,19,20,88,89,18,19,20,88,89,18,19,20,88,89,18,19,20,88,89,18,19,20,88,89,18,19,20,88,89,0,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,0,85,0,75,76,76,76},
    {111,111,111,111,111,111,111,112,85,0,75,76,77,0,84,0,93,94,24,25,26,93,94,24,25,26,93,94,24,25,26,93,94,24,25,26,93,94,24,25,26,93,94,24,25,26,93,94,0,85,0,75,76,76,76},
    {114,114,114,114,114,114,114,115,85,0,75,76,77,0,84,0,93,92,128,128,128,92,92,128,128,128,92,92,128,128,128,92,92,128,128,128,92,92,128,128,128,92,92,128,128,128,92,94,0,85,0,75,76,76,76},
    {121,122,121,122,121,122,121,123,85,0,78,79,80,0,84,0,93,92,129,129,129,92,92,129,129,129,92,92,129,129,129,92,92,129,129,129,92,92,129,129,129,92,92,129,129,129,92,94,0,85,0,75,76,76,76},
    {121,122,121,122,121,122,121,123,85,0,0,4,0,0,84,0,93,92,18,19,20,92,92,18,19,20,92,92,18,19,20,92,92,18,19,20,92,92,18,19,20,92,92,18,19,20,92,94,0,85,0,75,76,76,76},
    {121,122,121,122,121,122,121,123,85,81,82,82,82,83,84,0,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,21,22,23,93,94,0,85,0,75,76,76,76},
    {125,125,125,125,125,125,125,126,85,0,0,0,0,0,84,0,90,91,24,25,26,90,91,24,25,26,90,91,24,25,26,90,91,24,25,26,90,91,24,25,26,90,91,24,25,26,90,91,0,85,0,75,76,76,76},
    {0,0,0,0,0,0,0,0,85,0,0,0,0,0,84,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,0,75,76,76,76},
    {82,82,82,82,82,82,82,82,87,0,0,0,0,0,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,87,0,75,76,76,76},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,76,76,76}
};

Map::Map() {
    map = NULL;
    mapWidth = 0;
    mapHeight = 0;
}

Map::~Map() {
    freeMap();
}

void Map::freeMap() {
    for (int i = 0; i < mapHeight; i++) {
        delete[] map[i];
    }
    delete[] map;
}

void Map::loadMap() {
    g2TileSheet.loadTileSheet("res/tileset/tileset03.png");
    mapHeight = 38;
    mapWidth = 55;
    map = new int*[mapHeight];
    for (int i = 0; i < mapHeight; i++) {
        map[i] = new int[mapWidth];
    }
    for (int i = 0; i < mapHeight; i++) {
        for (int j = 0; j < mapWidth; j++) {
            map[i][j] = hardMap[i][j];
        }
    }
}

void Map::drawMap() {
    for (int i = 0; i < mapHeight; i++) {
        for (int j = 0; j < mapWidth; j++) {
            Tile drawTile;
            drawTile.defineTile(&g2TileSheet, map[i][j], 0);
            SDL_Rect dstRect;
            dstRect.x = j*64;
            dstRect.y = i*64;
            dstRect.w = 64;
            dstRect.h = 64;
            SDL_RenderCopy(RenderWindow::renderer, g2TileSheet.getTileSheet(), drawTile.getClip(), &dstRect);
        }
    }
}